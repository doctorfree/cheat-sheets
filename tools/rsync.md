# rsync cheatsheet

***rsync*** is a utility for efficiently transferring and synchronizing files between a computer and a storage drive and across networked computers by comparing the modification times and sizes of files. It is commonly found on Unix-like operating systems and is under the GPL-3.0-or-later license.

Rsync is written in C as a single threaded application. The rsync algorithm is a type of delta encoding, and is used for minimizing network usage. Zlib may be used for additional data compression, and SSH or stunnel can be used for security. Rsync is the facility typically used for synchronizing software repositories on mirror sites used by package management systems.

Rsync is typically used for synchronizing files and directories between two different systems. For example, if the command rsync local-file user@remote-host:remote-file is run, rsync will use SSH to connect as user to remote-host. Once connected, it will invoke the remote host's rsync and then the two programs will determine what parts of the local file need to be transferred so that the remote file matches the local one.

Rsync can also operate in a daemon mode (rsyncd), serving and receiving files in the native rsync protocol (using the "rsync://" syntax).

## Sync folder in-progress to final

```
rsync -avz ./in-progress /final
```

## Sync the content from in-progress to final

```
rsync -avz ./in-progress/ /final
```

## Sync the content from in-progress to final and exclude the contents from in-progress/junk/

```
rsync -avz --exclude=junk/* ./in-progress/ /final
```

## Rsync over SSH

```
rsync -avz /var/www/ user@1.2.3.4:/var/www/
```

To copy files from remote to local, maintaining file properties and sym-links
(-a), zipping for faster transfer (-z), verbose (-v):

```shell
rsync -avz host:file1 :file1 /dest/
rsync -avz /source host:/dest
```

To copy files using checksum (-c) rather than time to detect if the file has
changed. (Useful for validating backups):

```shell
rsync -avc <src> <dest>
```

To copy /src/foo folder into destination:

```shell
# This command will create /dest/foo if it does not already exist
rsync -auv /src/foo /dest
```

To copy contents of /src/foo into destination:

```shell
# This command will not create /foo_bak/foo folder
rsync -auv /src/foo/ /foo_bak
```

To copy file from local to remote over ssh with non standard port 1234 to
destination folder in remoteuser's home directory:

```shell
rsync -avz -e "ssh -p1234" <source> <username>@<host>:<dest>
```

Use the specified authentication key, instead of typing a password:

```shell
# The key can be generated by ssh-keygen, and the public key should be
# placed in remote's authorized_keys, e.g. using ssh-copy-id)
rsync -avz -e "ssh -i ~/.ssh/id_rsa" <src> <dest>
```

Log into remote as a user, but promote to root, to access privileged files:

```shell
rsync -avz --rsync-path="sudo rsync" user@<src> <dest>
```

Rsync only symlinks and preserve them as symlinks (dont follow them):

```shell
find /path/to/files -type l -print | \
  rsync -av --files-from=- /path/to/files user@targethost:/dest_path
```

Transfer file from local to remote host:

```shell
rsync path/to/local_file remote_host:path/to/remote_directory
```

Transfer file from remote host to local:

```shell
rsync remote_host:path/to/remote_file path/to/local_directory
```

Transfer file in [a]rchive (to preserve attributes) and compressed ([z]ipped) mode with [v]erbose and [h]uman-readable [P]rogress:

```shell
rsync -azvhP path/to/local_file remote_host:path/to/remote_directory
```

Transfer a directory and all its children from a remote to local:

```shell
rsync -r remote_host:path/to/remote_directory path/to/local_directory
```

Transfer directory contents (but not the directory itself) from a remote to local:

```shell
rsync -r remote_host:path/to/remote_directory/ path/to/local_directory
```

Transfer a directory [r]ecursively, in [a]rchive to preserve attributes, resolving contained soft[l]inks , and ignoring already transferred files [u]nless newer:

```shell
rsync -rauL remote_host:path/to/remote_directory path/to/local_directory
```

Transfer file over SSH and delete remote files that do not exist locally:

```shell
rsync -e ssh --delete remote_host:path/to/remote_file path/to/local_file
```

Transfer file over SSH using a different port than the default and show global progress:

```shell
rsync -e 'ssh -p port' --info=progress2 remote_host:path/to/remote_file path/to/local_file
```

## More examples
- [resource](https://devhints.io/rsync)
